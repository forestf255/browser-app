<!DOCTYPE html>
<html>
<body>
<div id="display"></div>
<form>Sensor 1:<input type="text" name="sensor1">
    <input type="submit" value="Submit">
</form>
<form>Sensor 2:<input type="text" name="sensor2">
    <input type="submit" value="Submit">
</form>
<form>Sensor 3:<input type="text" name="sensor3">
    <input type="submit" value="Submit">
</form>
</body>
<script>
    function getValues() {
    fetch('http://127.0.0.1:5000/')
        // Wait until all HTML text is received
        .then(response => response.text())
        .then(html => {
            let parser = new DOMParser();
            let doc = parser.parseFromString(html, "text/html");
            let readings = doc.getElementsByClassName("readings");
            // Place the table from the HTTP get into our "display" div
            // TODO: Maybe add HTML sanitization here
            document.getElementById("display").innerHTML = readings[0].outerHTML;
        })
    }

    function setValues(event) {
        // Prevent page refresh and form submission
        event.preventDefault();
        // Creates FormData from HTML form element
        var formData = new FormData(event.target);
        fetch('http://127.0.0.1:5000/', {
            method: 'POST',
            body: formData
        }).then(response => getValues());
    }

    getValues();
    // Refresh readings table with 1 second interval
    window.setInterval(getValues, 1000);
    document.addEventListener("submit", setValues, true);
</script>
</html>
